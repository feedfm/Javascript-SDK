var Feed=function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var y=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),g=t(function(t){var e=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),c=(g.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),v=function(t){if(!c(t))throw TypeError(t+" is not an object!");return t},u=function(t){try{return!!t()}catch(t){return!0}},n=!u(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),e=y.document,i=c(e)&&c(e.createElement),o=function(t){return i?e.createElement(t):{}},r=!n&&!u(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),s=function(t,e){if(!c(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!c(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!c(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!c(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},a=Object.defineProperty,l={f:n?Object.defineProperty:function(t,e,i){if(v(t),e=s(e,!0),v(i),r)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},k=n?function(t,e,i){return l.f(t,e,S(1,i))}:function(t,e,i){return t[e]=i,t},d={}.hasOwnProperty,p=function(t,e){return d.call(t,e)},f=0,h=Math.random(),m=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++f+h).toString(36))},w=t(function(t){var r=m("src"),e="toString",i=Function[e],s=(""+i).split(e);g.inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,i,n){var o="function"==typeof i;o&&(p(i,"name")||k(i,"name",e)),t[e]!==i&&(o&&(p(i,r)||k(i,r,t[e]?""+t[e]:s.join(String(e)))),t===y?t[e]=i:n?t[e]?t[e]=i:k(t,e,i):(delete t[e],k(t,e,i)))})(Function.prototype,e,function(){return"function"==typeof this&&this[r]||i.call(this)})}),_=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},b=function(n,o,t){if(_(n),void 0===o)return n;switch(t){case 1:return function(t){return n.call(o,t)};case 2:return function(t,e){return n.call(o,t,e)};case 3:return function(t,e,i){return n.call(o,t,e,i)}}return function(){return n.apply(o,arguments)}},P="prototype",O=function(t,e,i){var n,o,r,s,a=t&O.F,u=t&O.G,c=t&O.S,l=t&O.P,d=t&O.B,p=u?y:c?y[e]||(y[e]={}):(y[e]||{})[P],f=u?g:g[e]||(g[e]={}),h=f[P]||(f[P]={});for(n in u&&(i=e),i)r=((o=!a&&p&&void 0!==p[n])?p:i)[n],s=d&&o?b(r,y):l&&"function"==typeof r?b(Function.call,r):r,p&&w(p,n,r,t&O.U),f[n]!=r&&k(f,n,s),l&&h[n]!=r&&(h[n]=r)};y.core=g,O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var E,A=O,x={}.toString,T=function(t){return x.call(t).slice(8,-1)},I=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},j=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},C=function(t){return I(j(t))},L=Math.ceil,R=Math.floor,q=function(t){return isNaN(t=+t)?0:(0<t?R:L)(t)},N=Math.min,M=function(t){return 0<t?N(q(t),9007199254740991):0},B=Math.max,D=Math.min,F=t(function(t){var e="__core-js_shared__",i=y[e]||(y[e]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:g.version,mode:"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})}),V=F("keys"),$=function(t){return V[t]||(V[t]=m(t))},U=(E=!1,function(t,e,i){var n,o,r,s=C(t),a=M(s.length),u=(o=a,(n=q(n=i))<0?B(n+o,0):D(n,o));if(E&&e!=e){for(;u<a;)if((r=s[u++])!=r)return!0}else for(;u<a;u++)if((E||u in s)&&s[u]===e)return E||u||0;return!E&&-1}),W=$("IE_PROTO"),z=function(t,e){var i,n=C(t),o=0,r=[];for(i in n)i!=W&&p(n,i)&&r.push(i);for(;e.length>o;)p(n,i=e[o++])&&(~U(r,i)||r.push(i));return r},H="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),J=Object.keys||function(t){return z(t,H)},G={f:Object.getOwnPropertySymbols},K={f:{}.propertyIsEnumerable},Y=function(t){return Object(j(t))},Q=Object.assign,X=!Q||u(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=Q({},t)[i]||Object.keys(Q({},e)).join("")!=n})?function(t,e){for(var i=Y(t),n=arguments.length,o=1,r=G.f,s=K.f;o<n;)for(var a,u=I(arguments[o++]),c=r?J(u).concat(r(u)):J(u),l=c.length,d=0;d<l;)s.call(u,a=c[d++])&&(i[a]=u[a]);return i}:Q;A(A.S+A.F,"Object",{assign:X});var Z=!1,tt=function t(){var e,i=Array.prototype.slice.call(arguments);i[0]="feed.fm: "+i[0],Z&&console.log.apply(console,i);try{e=JSON.stringify({ts:new Date,message:i[0],args:i.slice(1)})}catch(t){e=JSON.stringify({ts:new Date,message:i[0],args:"truncated"})}t.history.push(e),500<history.length&&t.history.shift()};tt.history=[],tt.enable=function(){Z=!0};var et,it,nt,ot,rt,st,at,ut=t(function(t){var e=F("wks"),i=y.Symbol,n="function"==typeof i;(t.exports=function(t){return e[t]||(e[t]=n&&i[t]||(n?i:m)("Symbol."+t))}).store=e}),ct=ut("match"),lt=function(t){var e;return c(t)&&(void 0!==(e=t[ct])?!!e:"RegExp"==T(t))};function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}it=2,nt=function(o,r,s){var f=lt,h=s,y=[].push,t="split",g="length",v="lastIndex";if("c"=="abbc"[t](/(b)*/)[1]||4!="test"[t](/(?:)/,-1)[g]||2!="ab"[t](/(?:ab)*/)[g]||4!="."[t](/(.?)(.?)/)[g]||1<"."[t](/()()/)[g]||""[t](/.?/)[g]){var m=void 0===/()??/.exec("")[1];s=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!f(t))return h.call(i,t,e);var n,o,r,s,a,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),l=0,d=void 0===e?4294967295:e>>>0,p=new RegExp(t.source,c+"g");for(m||(n=new RegExp("^"+p.source+"$(?!\\s)",c));(o=p.exec(i))&&!(l<(r=o.index+o[0][g])&&(u.push(i.slice(l,o.index)),!m&&1<o[g]&&o[0].replace(n,function(){for(a=1;a<arguments[g]-2;a++)void 0===arguments[a]&&(o[a]=void 0)}),1<o[g]&&o.index<i[g]&&y.apply(u,o.slice(1)),s=o[0][g],l=r,u[g]>=d));)p[v]===o.index&&p[v]++;return l===i[g]?!s&&p.test("")||u.push(""):u.push(i.slice(l)),u[g]>d?u.slice(0,d):u}}else"0"[t](void 0,0)[g]&&(s=function(t,e){return void 0===t&&0===e?[]:h.call(this,t,e)});return[function(t,e){var i=o(this),n=null==t?void 0:t[r];return void 0!==n?n.call(t,i,e):s.call(String(i),t,e)},s]},ot=ut(et="split"),rt=nt(j,ot,""[et]),st=rt[0],at=rt[1],u(function(){var t={};return t[ot]=function(){return 7},7!=""[et](t)})&&(w(String.prototype,et,st),k(RegExp.prototype,ot,2==it?function(t,e){return at.call(t,this,e)}:function(t){return at.call(t,this)}));var ft=ut("unscopables"),ht=Array.prototype;null==ht[ft]&&k(ht,ft,{});var yt=function(t){ht[ft][t]=!0},gt=function(t,e){return{value:e,done:!!t}},vt={},mt=n?Object.defineProperties:function(t,e){v(t);for(var i,n=J(e),o=n.length,r=0;r<o;)l.f(t,i=n[r++],e[i]);return t},_t=y.document,bt=_t&&_t.documentElement,Pt=$("IE_PROTO"),St=function(){},kt="prototype",wt=function(){var t,e=o("iframe"),i=H.length;for(e.style.display="none",bt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),wt=t.F;i--;)delete wt[kt][H[i]];return wt()},Ot=Object.create||function(t,e){var i;return null!==t?(St[kt]=v(t),i=new St,St[kt]=null,i[Pt]=t):i=wt(),void 0===e?i:mt(i,e)},Et=l.f,At=ut("toStringTag"),xt=function(t,e,i){t&&!p(t=i?t:t.prototype,At)&&Et(t,At,{configurable:!0,value:e})},Tt={};k(Tt,ut("iterator"),function(){return this});var It=$("IE_PROTO"),jt=Object.prototype,Ct=Object.getPrototypeOf||function(t){return t=Y(t),p(t,It)?t[It]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?jt:null},Lt=ut("iterator"),Rt=!([].keys&&"next"in[].keys()),qt="values",Nt=function(){return this},Mt=function(t,e,i,n,o,r,s){var a,u,c;u=e,c=n,(a=i).prototype=Ot(Tt,{next:S(1,c)}),xt(a,u+" Iterator");var l,d,p,f=function(t){if(!Rt&&t in v)return v[t];switch(t){case"keys":case qt:return function(){return new i(this,t)}}return function(){return new i(this,t)}},h=e+" Iterator",y=o==qt,g=!1,v=t.prototype,m=v[Lt]||v["@@iterator"]||o&&v[o],_=m||f(o),b=o?y?f("entries"):_:void 0,P="Array"==e&&v.entries||m;if(P&&(p=Ct(P.call(new t)))!==Object.prototype&&p.next&&(xt(p,h,!0),"function"!=typeof p[Lt]&&k(p,Lt,Nt)),y&&m&&m.name!==qt&&(g=!0,_=function(){return m.call(this)}),(Rt||g||!v[Lt])&&k(v,Lt,_),vt[e]=_,vt[h]=Nt,o)if(l={values:y?_:f(qt),keys:r?_:f("keys"),entries:b},s)for(d in l)d in v||w(v,d,l[d]);else A(A.P+A.F*(Rt||g),e,l);return l}(Array,"Array",function(t,e){this._t=C(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,gt(1)):gt(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values");vt.Arguments=vt.Array,yt("keys"),yt("values"),yt("entries");for(var Bt=ut("iterator"),Dt=ut("toStringTag"),Ft=vt.Array,Vt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},$t=J(Vt),Ut=0;Ut<$t.length;Ut++){var Wt,zt=$t[Ut],Ht=Vt[zt],Jt=y[zt],Gt=Jt&&Jt.prototype;if(Gt&&(Gt[Bt]||k(Gt,Bt,Ft),Gt[Dt]||k(Gt,Dt,zt),vt[zt]=Ft,Ht))for(Wt in Mt)Gt[Wt]||w(Gt,Wt,Mt[Wt],!0)}var Kt,Yt,Qt,Xt;Kt="keys",Yt=function(){return function(t){return J(Y(t))}},Qt=(g.Object||{})[Kt]||Object[Kt],(Xt={})[Kt]=Yt(Qt),A(A.S+A.F*u(function(){Qt(1)}),"Object",Xt);var Zt=l.f,te=Function.prototype,ee=/^\s*function ([^ (]*)/;"name"in te||n&&Zt(te,"name",{configurable:!0,get:function(){try{return(""+this).match(ee)[1]}catch(t){return""}}});var ie,ne,oe,re,se,ae,ue,ce,le,de=Array.isArray||function(t){return"Array"==T(t)},pe=ut("species"),fe=(oe=1==(ie=5),re=2==ie,se=3==ie,ae=4==ie,ue=6==ie,ce=5==ie||ue,le=ne||function(t,e){return de(i=t)&&("function"!=typeof(n=i.constructor)||n!==Array&&!de(n.prototype)||(n=void 0),c(n)&&null===(n=n[pe])&&(n=void 0)),new(void 0===n?Array:n)(e);var i,n},function(t,e,i){for(var n,o,r=Y(t),s=I(r),a=b(e,i,3),u=M(s.length),c=0,l=oe?le(t,u):re?le(t,0):void 0;c<u;c++)if((ce||c in s)&&(o=a(n=s[c],c,r),ie))if(oe)l[c]=o;else if(o)switch(ie){case 3:return!0;case 5:return n;case 6:return c;case 2:l.push(n)}else if(ae)return!1;return ue?-1:se||ae?ae:l}),he="find",ye=!0;he in[]&&Array(1)[he](function(){ye=!1}),A(A.P+A.F*ye,"Array",{find:function(t){return fe(this,t,1<arguments.length?arguments[1]:void 0)}}),yt(he);var ge=Object.getOwnPropertyDescriptor,ve={f:n?ge:function(t,e){if(t=C(t),e=s(e,!0),r)try{return ge(t,e)}catch(t){}if(p(t,e))return S(!K.f.call(t,e),t[e])}},me=function(t,e){if(v(t),!c(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},_e={set:Object.setPrototypeOf||("__proto__"in{}?function(t,i,n){try{(n=b(Function.call,ve.f(Object.prototype,"__proto__").set,2))(t,[]),i=!(t instanceof Array)}catch(t){i=!0}return function(t,e){return me(t,e),i?t.__proto__=e:n(t,e),t}}({},!1):void 0),check:me}.set,be=H.concat("length","prototype"),Pe={f:Object.getOwnPropertyNames||function(t){return z(t,be)}},Se=ut("species"),ke=function(t){var e=y[t];n&&e&&!e[Se]&&l.f(e,Se,{configurable:!0,get:function(){return this}})},we=l.f,Oe=Pe.f,Ee=y.RegExp,Ae=Ee,xe=Ee.prototype,Te=/a/g,Ie=/a/g,je=new Ee(Te)!==Te;if(n&&(!je||u(function(){return Ie[ut("match")]=!1,Ee(Te)!=Te||Ee(Ie)==Ie||"/a/i"!=Ee(Te,"i")}))){Ee=function(t,e){var i,n,o,r,s=this instanceof Ee,a=lt(t),u=void 0===e;return!s&&a&&t.constructor===Ee&&u?t:(i=je?new Ae(a&&!u?t.source:t,e):Ae((a=t instanceof Ee)?t.source:t,a&&u?function(){var t=v(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}.call(t):e),n=Ee,(r=(s?this:xe).constructor)!==n&&"function"==typeof r&&(o=r.prototype)!==n.prototype&&c(o)&&_e&&_e(i,o),i)};for(var Ce=function(e){e in Ee||we(Ee,e,{configurable:!0,get:function(){return Ae[e]},set:function(t){Ae[e]=t}})},Le=Oe(Ae),Re=0;Le.length>Re;)Ce(Le[Re++]);(xe.constructor=Ee).prototype=xe,w(y,"RegExp",Ee)}ke("RegExp");var qe=0;function Ne(t){return t+ ++qe}var Me=Array.prototype.indexOf;function Be(o,r,t,e){"function"==typeof r&&(e=t,t=r,r=!1);var i=t?o.map(t,e):o,s=[],a=[];return i.forEach(function(t,e){var i,n;(r?e&&a[a.length-1]===t:(n=t,null!==(i=a)&&(Me&&i.indexOf===Me?-1!=i.indexOf(n):i.some(function(t){return t===n}))))||(a.push(t),s.push(o[e]))}),s}function De(t,e){var i=e.map(function(t){return new RegExp(t)});return Be(t).filter(function(e){return i.find(function(t){return t.test(e)})})}function Fe(t,e,i){e<(t=t?2*t:200)&&(t=e),setTimeout(function(){i(t)},t)}for(var Ve=Array.prototype.slice,$e={on:function(t,e,i){return We(this,"on",t,[e,i])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this})),this},once:function(t,e,i){if(!We(this,"once",t,[e,i])||!e)return this;var n,o,r,s=this,a=(r=!(n=function(){s.off(t,a),e.apply(this,arguments)}),function(){return r||(r=!0,o=n.apply(this,arguments),n=null),o});return a._callback=e,this.on(t,a,i)},off:function(t,e,i){var n,o,r,s,a,u,c,l;if(!this._events||!We(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=0,u=(s=t?[t]:Object.keys(this._events)).length;a<u;a++)if(t=s[a],r=this._events[t]){if(this._events[t]=n=[],e||i)for(c=0,l=r.length;c<l;c++)o=r[c],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=Ve.call(arguments,1);if(!We(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&ze(i,e),n&&ze(n,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var o=!e&&!i;for(var r in"object"===dt(e)&&(i=this),t&&((n={})[t._listenerId]=t),n)n[r].off(e,i,this),o&&delete this._listeners[r];return this}},Ue=/\s+/,We=function(t,e,i,n){if(!i)return!0;if("object"===dt(i)){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(Ue.test(i)){for(var r=i.split(Ue),s=0,a=r.length;s<a;s++)t[e].apply(t,[r[s]].concat(n));return!1}return!0},ze=function(t,e){var i,n=-1,o=t.length,r=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}},He={listenTo:"on",listenToOnce:"once"},Je=Object.keys(He),Ge=function(){var t=Je[Ke],n=He[t];$e[t]=function(t,e,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=Ne("l"))]=t,"object"===dt(e)&&(i=this),t[n](e,i,this),this}},Ke=0;Ke<Je.length;Ke++)Ge();var Ye=/(iPhone|iPad)/i.test(navigator.userAgent),Qe=Ye&&/OS 13_[43210]/i.test(navigator.userAgent),Xe=Ye?"https://u9e9h7z5.map2.ssl.hwcdn.net/feedfm-audio/250-milliseconds-of-silence.mp3":"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",Ze=function(t,e,i,n){var o=Object.assign(this,$e);if(o.id=i,o.url=n,o.speaker=t,o.loaded=!1,e){this.startPosition=+e.startPosition,this.endPosition=+e.endPosition,this.fadeInSeconds=+e.fadeInSeconds,this.fadeInSeconds?(this.fadeInStart=this.startPosition?this.startPosition/1e3:0,this.fadeInEnd=this.fadeInStart+this.fadeInSeconds):(this.fadeInStart=0,this.fadeInEnd=0),this.fadeOutSeconds=+e.fadeOutSeconds,this.fadeOutSeconds&&(this.endPosition?(this.fadeOutStart=this.endPosition/1e3-this.fadeOutSeconds,this.fadeOutEnd=this.endPosition/1e3):(this.fadeOutStart=0,this.fadeOutEnd=0));for(var r=["play","pause","finish","elapse"],s=0;s<r.length;s++){var a=r[s];a in e&&o.on(a,e[a])}this.gain=e.gain||0}else this.gain=0;return o};function ti(t){return" src = "+t.src+", time = "+t.currentTime+", paused = "+t.paused+", duration = "+t.duration+", readyState = "+t.readyState}Ze.prototype={play:function(){return tt("sound "+this.id+" play"),this.speaker._playSound(this)},pause:function(){return tt("sound "+this.id+" pause"),this.speaker._pauseSound(this)},resume:function(){return tt("sound "+this.id+" resume"),this.speaker._playSound(this)},position:function(){return this.speaker._position(this)},duration:function(){return this.speaker._duration(this)},destroy:function(){tt("sound "+this.id+" destroy"),this.speaker._destroySound(this)},gainAdjustedVolume:function(t){return this.gain?Math.max(Math.min(t/100*(50*Math.pow(10,this.gain/20)),100),0)/100:t/100}};var ei=function(){};ei.iOSp=Ye,ei.brokenWebkit=Qe,ei.prototype={vol:100,outstandingSounds:{},audioContext:null,active:null,fading:null,preparing:null,prepareWhenReady:null,initializeAudio:function(){null===this.active?(tt("initializing for mobile"),this.audioContext=function(){var t=window.AudioContext||window.webkitAudioContext,e=new t;if(44100!==e.sampleRate){var i=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=i,n.connect(e.destination),n.start(0),n.disconnect(),e.close(),e=new t}return e}(),this.active=this._createAudio(Xe),this.fading=this._createAudio(Xe),this.preparing=this._createAudio(this.prepareWhenReady?this.prepareWhenReady:Xe),this.prepareWhenReady=null):tt("mobile already initialized")},getSupportedFormats:function(){return document.createElement("audio").canPlayType("audio/aac")?"aac,mp3":"mp3"},_createAudioGainNode:function(t){var e=this.audioContext.createMediaElementSource(t),i=this.audioContext.createGain();return i.gain.value=1,e.connect(i),i.connect(this.audioContext.destination),i.gain},_createAudio:function(t){var e=new Audio(t);e.crossOrigin="anonymous",e.loop=!1,e.volume=1,this._addEventListeners(e);var i=null;return Ye&&!Qe&&(i=this._createAudioGainNode(e)),{audio:e,sound:null,gain:i,volume:1}},_addEventListeners:function(t){t.addEventListener("pause",this._onAudioPauseEvent.bind(this)),t.addEventListener("ended",this._onAudioEndedEvent.bind(this)),t.addEventListener("timeupdate",this._onAudioTimeUpdateEvent.bind(this))},_onAudioPauseEvent:function(t){var e=t.currentTarget;e.src!==Xe&&e===this.active.audio&&e.currentTime!==e.duration&&(this.active.sound&&this.active.sound.url===e.src?this.active.sound.trigger("pause"):tt("active audio pause, but no matching sound"))},_onAudioEndedEvent:function(t){var e=t.currentTarget;if(e.src!==Xe){if(e===this.fading.audio)return e.src=Xe,void(this.fading.sound=null);if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){tt("active audio ended");var i=this.active.sound;this.active.sound=null,i.trigger("finish")}else tt("active audio ended, but no matching sound",e.src)}},_onAudioTimeUpdateEvent:function(t){var e=t.currentTarget;if(e.src!==Xe)if(e===this.fading.audio&&this.fading.sound)this.fading.sound.endPosition&&e.currentTime>=this.fading.sound.endPosition/1e3?(this.fading.sound=null,this.fading.audio.src=Xe):this._setVolume(this.fading);else if(e===this.active.audio)if(this.active.sound&&this.active.sound.url===e.src){if(this.active.sound.endPosition&&this.active.sound.endPosition/1e3<=e.currentTime){var i=this.active.sound;this.active.sound=null,this.active.audio.src=Xe,i.trigger("finish")}else if(this.active.sound.fadeOutEnd&&e.currentTime>=this.active.sound.fadeOutStart){this._setVolume(this.active);var n=this.fading;this.fading=this.active,this.active=n,this.active.sound=null,this.fading.sound.trigger("finish")}else this._setVolume(this.active),this.active.sound.trigger("elapse");this.prepareWhenReady&&this.prepare(this.prepareWhenReady)}else tt("active audio elapsed, but no matching sound, so ignoring",e.src)},_setVolume:function(t,e){e||(e=t.sound);var i=t.audio.currentTime,n=t.volume,o=e.gainAdjustedVolume(this.vol);e.fadeInStart!==e.fadeInEnd&&i<e.fadeInStart?(o=0,tt("pre-fade-in volume is 0")):e.fadeInStart!==e.fadeInEnd&&i>=e.fadeInStart&&i<=e.fadeInEnd?(o=(i-e.fadeInStart)/(e.fadeInEnd-e.fadeInStart)*o,tt("ramping \u25b2 volume",{currentTime:i,currentVolume:n,calculatedVolume:o,sound:e})):e.fadeOutStart!==e.fadeOutEnd&&i>e.fadeOutEnd?(o=0,tt("post-fade-out volume is 0")):e.fadeOutStart!==e.fadeOutEnd&&i>=e.fadeOutStart&&i<=e.fadeOutEnd&&(o=(1-(i-e.fadeOutStart)/(e.fadeOutEnd-e.fadeOutStart))*o,tt("ramping \u25bc volume",{currentTime:i,currentVolume:n,calculatedVolume:o,sound:e})),n!==o&&(Ye?Qe||(t.gain.value=o):t.audio.volume=o,t.volume=o)},_debugAudioObject:function(t){for(var e=["abort","load","loadend","loadstart","loadeddata","loadedmetadata","canplay","canplaythrough","seeked","seeking","stalled","timeupdate","volumechange","waiting","durationchange","progress","emptied","ended","play","pause"],n=this,i=0;i<e.length;i++)t.addEventListener(e[i],function(t){var e=t.currentTarget,i=e===n.active.audio?"active":e===n.preparing.audio?"preparing":"fading";tt(i+": "+t.type),tt("    active: "+ti(n.active.audio)),tt("    preparing: "+ti(n.preparing.audio)),tt("    fading: "+ti(n.fading.audio)),e.src})},create:function(t,e){var i=Ne("feed-play-"),n=new Ze(this,e,i,t);return tt("created play "+i+" ("+t+")",e),this.outstandingSounds[n.id]=n,this.active&&this.active.audio?this.preparing.audio.src===Xe&&(tt("preparing sound now"),this._prepare(n.url,n.startPosition)):(tt("no audio prepared yet, so preparing when ready"),this.prepareWhenReady=n.url),n},prepare:function(t){if(!this.active||!this.active.audio)return tt("saving url to prepare for later",t),void(this.prepareWhenReady=t);var e=this.active.audio.buffered;return 0<e.length&&e.end(e.length-1)>=this.active.audio.duration?(tt("active song has loaded enough, to preparing",t),this._prepare(t,0)):this.active.audio.url===Xe?(tt("preparing over silence"),this._prepare(t,0)):(tt("nothing available to do active prepare"),void(this.prepareWhenReady=t))},logState:function(t){for(var e in console.group("speaker: "+(t||"")),this.active?(console.group("active"),console.log("audio.src: ".concat(this.active.audio.src)),console.log("audio.paused: ".concat(this.active.audio.paused)),console.log("sound: ".concat(this.active.sound?this.active.sound.id:"NULL")),console.log("volume: ".concat(this.active.volume)),console.groupEnd(),console.group("preparing"),console.log("audio.src: ".concat(this.preparing.audio.src)),console.log("audio.paused: ".concat(this.preparing.audio.paused)),console.log("sound: ".concat(this.preparing.sound?this.preparing.sound.id:"NULL")),console.log("volume: ".concat(this.preparing.volume)),console.groupEnd(),console.group("fading"),console.log("audio.src: ".concat(this.fading.audio.src)),console.log("audio.paused: ".concat(this.fading.audio.paused)),console.log("sound: ".concat(this.fading.sound?this.fading.sound.id:"NULL")),console.log("volume: ".concat(this.fading.volume))):(console.group("active"),console.log("uninitialized"),console.groupEnd(),console.group("preparing"),console.log("uninitialized"),console.groupEnd(),console.group("fading"),console.log("uninitialized")),console.groupEnd(),console.group("outstanding sounds"),this.outstandingSounds){var i=this.outstandingSounds[e];console.log(i.id+": "+i.url)}console.groupEnd(),console.groupEnd()},_prepare:function(t,e){this.prepareWhenReady=null,this.preparing.audio.src!==t&&(tt("preparing "+t),this.preparing.audio.src=t),e&&this.preparing.audio.currentTime!==e&&(tt("advancing preparing audio to",e/1e3),this.preparing.audio.currentTime=e/1e3)},_playSound:function(e){var i=this;if(this.active&&this.active.audio)if(this.active.sound===e)this.active.audio.paused?(tt(e.id+" was paused, so resuming"),this.active.audio.play().then(function(){tt("resumed playback"),e.trigger("play")}).catch(function(){tt("error resuming playback"),i.active.sound=null,e.trigger("finish")}),this.fading.sound&&this.fading.audio.play().then(function(){tt("resumed fading playback")}).catch(function(){tt("error resuming fading playback"),i.fading.sound=null,i.fading.audio.src=Xe})):tt(e.id+" is already playing");else{this.preparing.audio.src!==e.url&&this._prepare(e.url,e.startPosition);var t=this.active;if(this.active=this.preparing,this.preparing=t,this.active.sound=null,this._setVolume(this.active,e),this.preparing.sound){this.preparing.audio.src=Xe;var n=this.preparing.sound;this.preparing.sound=null,n.trigger("finish")}tt(e.id+" initiating play()");var o=this.active;this.active.audio.play().then(function(){if(!i.outstandingSounds[e.id])return tt(e.id+" play() succeeded, but sound has been destroyed"),void(o.audio&&o.audio.src===e.url&&(tt(e.id+" being paused and unloaded"),o.audio.pause(),o.audio.src=Xe));tt(e.id+" play() succeeded"),(o.sound=e).fadeOutSeconds&&0===e.fadeOutEnd&&(e.fadeOutStart=o.audio.duration-e.fadeOutSeconds,e.fadeOutEnd=o.audio.duration),e.startPosition&&(tt("updating start position"),o.audio.currentTime=e.startPosition/1e3,tt("updated"));var t=o.audio.paused;e.trigger("play"),o.pauseAfterPlay?o.audio.pause():t&&e.trigger("pause")}).catch(function(t){tt("error starting playback with sound "+e.id,t),e.trigger("finish",t)})}else console.error("**** player.initializeAudio() *** not called before playback!")},_destroySound:function(t){t.off(),this.active&&this.active.sound===t?(tt("destroy triggered for current sound",t.id),this.active.audio.pause()):tt("destroy triggered for inactive sound",t.id),delete this.outstandingSounds[t.id]},flush:function(){for(var t in this.outstandingSounds)this.outstandingSounds[t].destroy()},_pauseSound:function(t){this.active&&t.url===this.active.audio.src&&(this.active.sound===t?this.active.audio.pause():this.active.pauseAfterPlay=!0),this.fading&&this.fading.audio&&this.fading.audio.pause()},_position:function(t){return this.active&&t===this.active.sound?(t.url!==this.active.audio.src&&tt("trying to get current song position, but it is not in the active audio player"),Math.floor(1e3*this.active.audio.currentTime)):0},_duration:function(t){if(t!==this.active.sound)return 0;t.url!==this.active.audio.src&&tt("trying to get current song duration, but it is not in the active audio player");var e=this.active.audio.duration;return isNaN(e)?0:Math.floor(1e3*e)},setVolume:function(t){return void 0!==t&&(this.vol=t,this.active&&this.active.sound&&this._setVolume(this.active),this.trigger("volume",t)),this.vol}},Object.assign(ei.prototype,$e);var ii="1.99.16",ni=ut("species"),oi=function(t,e){var i,n=v(t).constructor;return void 0===n||null==(i=v(n)[ni])?e:_(i)};function ri(t){var i,n;this.promise=new t(function(t,e){if(void 0!==i||void 0!==n)throw TypeError("Bad Promise constructor");i=t,n=e}),this.resolve=_(i),this.reject=_(n)}var si={f:function(t){return new ri(t)}},ai=function(t,e){if(v(t),c(e)&&e.constructor===t)return e;var i=si.f(t);return(0,i.resolve)(e),i.promise};A(A.P+A.R,"Promise",{finally:function(e){var i=oi(this,g.Promise||y.Promise),t="function"==typeof e;return this.then(t?function(t){return ai(i,e()).then(function(){return t})}:e,t?function(t){return ai(i,e()).then(function(){throw t})}:e)}});var ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function ci(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function li(t){var e=t.charAt(t.length-1),i=parseInt(t,10),n=new Date;switch(e){case"Y":n.setFullYear(n.getFullYear()+i);break;case"M":n.setMonth(n.getMonth()+i);break;case"D":n.setDate(n.getDate()+i);break;case"h":n.setHours(n.getHours()+i);break;case"m":n.setMinutes(n.getMinutes()+i);break;case"s":n.setSeconds(n.getSeconds()+i);break;default:n=new Date(t)}return n}var di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function pi(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:decodeURIComponent;if("string"!=typeof t||!t)return null;var i=new RegExp("(?:^|; )"+t.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")+"(?:=([^;]*))?(?:;|$)").exec(document.cookie);return null===i?null:"function"==typeof e?e(i[1]):i[1]}function fi(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:encodeURIComponent,n=arguments[3];"object"===(void 0===i?"undefined":di(i))&&null!==i&&(n=i,i=encodeURIComponent);var o=function(t){var e="";for(var i in t)if(ci(t,i))if(/^expires$/i.test(i)){var n=t[i];"object"!==(void 0===n?"undefined":ui(n))&&(n=li(n+="number"==typeof n?"D":"")),e+=";"+i+"="+n.toUTCString()}else/^secure$/.test(i)?t[i]&&(e+=";"+i):e+=";"+i+"="+t[i];return ci(t,"path")||(e+=";path=/"),e}(n||{}),r=t+"="+("function"==typeof i?i(e):e)+o;document.cookie=r}function hi(t,e){var i={expires:-1};return e&&e.domain&&(i.domain=e.domain),fi(t,"a",i)}var yi="https://feed.fm";function gi(){return yi}function vi(t){var e,i;"//"===(e=t).slice(0,2)&&(e=!0===i?"https:"+e:!1===i?"http:"+e:"http"===window.location.protocol.substr(0,4)?window.location.protocol+e:"http"),yi=e,console.log("updated url to",yi)}var mi,_i,bi,Pi=ut("toStringTag"),Si="Arguments"==T(function(){return arguments}()),ki=function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Pi))?i:Si?T(e):"Object"==(n=T(e))&&"function"==typeof e.callee?"Arguments":n},wi=function(e,t,i,n){try{return n?t(v(i)[0],i[1]):t(i)}catch(t){var o=e.return;throw void 0!==o&&v(o.call(e)),t}},Oi=ut("iterator"),Ei=Array.prototype,Ai=ut("iterator"),xi=g.getIteratorMethod=function(t){if(null!=t)return t[Ai]||t["@@iterator"]||vt[ki(t)]},Ti=t(function(t){var f={},h={},e=t.exports=function(t,e,i,n,o){var r,s,a,u,c,l=o?function(){return t}:xi(t),d=b(i,n,e?2:1),p=0;if("function"!=typeof l)throw TypeError(t+" is not iterable!");if(void 0===(c=l)||vt.Array!==c&&Ei[Oi]!==c){for(a=l.call(t);!(s=a.next()).done;)if((u=wi(a,d,s.value,e))===f||u===h)return u}else for(r=M(t.length);p<r;p++)if((u=e?d(v(s=t[p])[0],s[1]):d(t[p]))===f||u===h)return u};e.BREAK=f,e.RETURN=h}),Ii=y.process,ji=y.setImmediate,Ci=y.clearImmediate,Li=y.MessageChannel,Ri=y.Dispatch,qi=0,Ni={},Mi="onreadystatechange",Bi=function(){var t=+this;if(Ni.hasOwnProperty(t)){var e=Ni[t];delete Ni[t],e()}},Di=function(t){Bi.call(t.data)};ji&&Ci||(ji=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return Ni[++qi]=function(){!function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}t.apply(i,e)}("function"==typeof t?t:Function(t),e)},mi(qi),qi},Ci=function(t){delete Ni[t]},"process"==T(Ii)?mi=function(t){Ii.nextTick(b(Bi,t,1))}:Ri&&Ri.now?mi=function(t){Ri.now(b(Bi,t,1))}:Li?(bi=(_i=new Li).port2,_i.port1.onmessage=Di,mi=b(bi.postMessage,bi,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts?(mi=function(t){y.postMessage(t+"","*")},y.addEventListener("message",Di,!1)):mi=Mi in o("script")?function(t){bt.appendChild(o("script"))[Mi]=function(){bt.removeChild(this),Bi.call(t)}}:function(t){setTimeout(b(Bi,t,1),0)});var Fi={set:ji,clear:Ci},Vi=Fi.set,$i=y.MutationObserver||y.WebKitMutationObserver,Ui=y.process,Wi=y.Promise,zi="process"==T(Ui),Hi=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Ji=y.navigator,Gi=Ji&&Ji.userAgent||"",Ki=ut("iterator"),Yi=!1;try{var Qi=[7][Ki]();Qi.return=function(){Yi=!0},Array.from(Qi,function(){throw 2})}catch(t){}var Xi,Zi,tn,en,nn=Fi.set,on=function(){var i,n,o,t=function(){var t,e;for(zi&&(t=Ui.domain)&&t.exit();i;){e=i.fn,i=i.next;try{e()}catch(t){throw i?o():n=void 0,t}}n=void 0,t&&t.enter()};if(zi)o=function(){Ui.nextTick(t)};else if(!$i||y.navigator&&y.navigator.standalone)if(Wi&&Wi.resolve){var e=Wi.resolve(void 0);o=function(){e.then(t)}}else o=function(){Vi.call(y,t)};else{var r=!0,s=document.createTextNode("");new $i(t).observe(s,{characterData:!0}),o=function(){s.data=r=!r}}return function(t){var e={fn:t,next:void 0};n&&(n.next=e),i||(i=e,o()),n=e}}(),rn="Promise",sn=y.TypeError,an=y.process,un=an&&an.versions,cn=un&&un.v8||"",ln=y[rn],dn="process"==ki(an),pn=function(){},fn=Zi=si.f,hn=!!function(){try{var t=ln.resolve(1),e=(t.constructor={})[ut("species")]=function(t){t(pn,pn)};return(dn||"function"==typeof PromiseRejectionEvent)&&t.then(pn)instanceof e&&0!==cn.indexOf("6.6")&&-1===Gi.indexOf("Chrome/66")}catch(t){}}(),yn=function(t){var e;return!(!c(t)||"function"!=typeof(e=t.then))&&e},gn=function(l,i){if(!l._n){l._n=!0;var n=l._c;on(function(){for(var u=l._v,c=1==l._s,t=0,e=function(t){var e,i,n,o=c?t.ok:t.fail,r=t.resolve,s=t.reject,a=t.domain;try{o?(c||(2==l._h&&_n(l),l._h=1),!0===o?e=u:(a&&a.enter(),e=o(u),a&&(a.exit(),n=!0)),e===t.promise?s(sn("Promise-chain cycle")):(i=yn(e))?i.call(e,r,s):r(e)):s(u)}catch(t){a&&!n&&a.exit(),s(t)}};n.length>t;)e(n[t++]);l._c=[],l._n=!1,i&&!l._h&&vn(l)})}},vn=function(r){nn.call(y,function(){var t,e,i,n=r._v,o=mn(r);if(o&&(t=Hi(function(){dn?an.emit("unhandledRejection",n,r):(e=y.onunhandledrejection)?e({promise:r,reason:n}):(i=y.console)&&i.error&&i.error("Unhandled promise rejection",n)}),r._h=dn||mn(r)?2:1),r._a=void 0,o&&t.e)throw t.v})},mn=function(t){return 1!==t._h&&0===(t._a||t._c).length},_n=function(e){nn.call(y,function(){var t;dn?an.emit("rejectionHandled",e):(t=y.onrejectionhandled)&&t({promise:e,reason:e._v})})},bn=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),gn(e,!0))},Pn=function(t){var i,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw sn("Promise can't be resolved itself");(i=yn(t))?on(function(){var e={_w:n,_d:!1};try{i.call(t,b(Pn,e,1),b(bn,e,1))}catch(t){bn.call(e,t)}}):(n._v=t,n._s=1,gn(n,!1))}catch(t){bn.call({_w:n,_d:!1},t)}}};hn||(ln=function(t){!function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!")}(this,ln,rn,"_h"),_(t),Xi.call(this);try{t(b(Pn,this,1),b(bn,this,1))}catch(t){bn.call(this,t)}},(Xi=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,i){for(var n in e)w(t,n,e[n],i);return t}(ln.prototype,{then:function(t,e){var i=fn(oi(this,ln));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=dn?an.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&gn(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),tn=function(){var t=new Xi;this.promise=t,this.resolve=b(Pn,t,1),this.reject=b(bn,t,1)},si.f=fn=function(t){return t===ln||t===en?new tn(t):Zi(t)}),A(A.G+A.W+A.F*!hn,{Promise:ln}),xt(ln,rn),ke(rn),en=g[rn],A(A.S+A.F*!hn,rn,{reject:function(t){var e=fn(this);return(0,e.reject)(t),e.promise}}),A(A.S+A.F*!hn,rn,{resolve:function(t){return ai(this,t)}}),A(A.S+A.F*!(hn&&function(t,e){if(!e&&!Yi)return!1;var i=!1;try{var n=[7],o=n[Ki]();o.next=function(){return{done:i=!0}},n[Ki]=function(){return o},t(n)}catch(t){}return i}(function(t){ln.all(t).catch(pn)})),rn,{all:function(t){var s=this,e=fn(s),a=e.resolve,u=e.reject,i=Hi(function(){var n=[],o=0,r=1;Ti(t,!1,function(t){var e=o++,i=!1;n.push(void 0),r++,s.resolve(t).then(function(t){i||(i=!0,n[e]=t,--r||a(n))},u)}),--r||a(n)});return i.e&&u(i.v),e.promise},race:function(t){var e=this,i=fn(e),n=i.reject,o=Hi(function(){Ti(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return o.e&&n(o.v),i.promise}});var Sn,kn="cid";function wn(i,n){var t=pi(kn);if(t)return i(t);fetch(gi()+"/api/v2/client",{method:"POST"}).then(function(t){return t.json()}).then(function(t){t.success?i(t.client_id):Fe(n,2e3,function(t){wn(i,t)})}).catch(function(t){if(403===t.status)try{var e=JSON.parse(t.responseText);tt("error trying to get client id:",e)}catch(t){tt("unknown response for client id request",t.message)}else tt("unknown client id response status",t.status);Fe(n,2e3,function(t){wn(i,t)})})}function On(){return Sn||(Sn=new Promise(function(e){wn(function(t){fi(kn,t,{expires:3650,path:"/"}),e(t)})})),Sn}var En=function(t,e,i){(i=i||{}).baseUrl&&vi(i.baseUrl),this.config={formats:"mp3,aac",maxBitrate:128,timeOffset:0,current:null,pendingRequest:null,pendingPlay:null},Object.assign(this,$e),t&&e&&this.setCredentials(t,e)};En.prototype.setCredentials=function(t,e){this.config.token=t,this.config.secret=e},En.prototype.setPlacementId=function(t){this.config.placementId=t,this.trigger("placement-changed",t),this._retune()},En.prototype.setStationId=function(t){""+this.config.stationId!=""+t&&(this.config.stationId=t,this.trigger("station-changed",t),this._retune())},En.prototype.setFormats=function(t){this.config.formats=t,this._retune()},En.prototype.setMaxBitrate=function(t){this.config.maxBitrate=t},En.prototype.tune=function(){if(!this.config.token)throw new Error("no token set with setCredentials()");if(!this.config.secret)throw new Error("no secret set with setCredentials()");this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0),this._getDefaultPlacementInformation()},En.prototype._getDefaultPlacementInformation=function(e){var i=this;this.config.placementId&&this.config.placement&&this.config.placement.id===this.config.placementId?this._requestNextPlay():On().then(function(t){tt("requesting default placement information from server"),i._signedAjax(gi()+"/api/v2/placement?client_id="+t).then(function(t){return t.json()}).then(i._receiveDefaultPlacementInformation.bind(i)).catch(i._failedDefaultPlacementInformation.bind(i,e))})},En.prototype._receiveDefaultPlacementInformation=function(t){t&&t.success&&t.placement&&(this.config.placement=t.placement,this.config.stations=t.stations,this.config.placementId=t.placement.id,this.trigger("placement-changed",this.config.placementId),this.trigger("placement",t.placement),!("stationId"in this.config)&&0<t.stations.length&&(this.config.stationId=t.stations[0].id,this.trigger("station-changed",this.config.stationId)),this.trigger("stations",t.stations),this._requestNextPlay())},En.prototype._failedDefaultPlacementInformation=function(t,e){var i=this;if(401===e.status)try{var n=JSON.parse(e.responseText);if(n.error&&5===n.error.code)return void this.trigger("invalid-credentials")}catch(t){}else console.warn("error from placement request",e);t=t?2*t:500,setTimeout(function(){i._getDefaultPlacementInformation(t)},t)},En.prototype.getActivePlacement=function(){return this.config.placement?this.config.placement:null},En.prototype.getActivePlay=function(){return this.config.current?this.config.current.play:null},En.prototype.isTuned=function(){return this.config.current||this.config.pendingRequest},En.prototype.hasActivePlayStarted=function(){return this.config.current&&this.config.current.started},En.prototype._retune=function(){this.isTuned()&&this.tune()},En.prototype.reportPlayStarted=function(){if(!this.config.current)throw new Error("attempt to report a play started, but there is no active play");this._startPlay(this.config.current.play)},En.prototype.reportPlayElapsed=function(t){if(!this.config.current)throw new Error("attempt to report elapsed play time, but the play hasn't started");this._signedAjax(gi()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:t}),headers:{"Content-Type":"application/json"}})},En.prototype.reportPlayCompleted=function(){if(!this.config.current||!this.config.current.started)throw tt("finish on non-active or playing song"),new Error("no active or playing song");this._signedAjax(gi()+"/api/v2/play/"+this.config.current.play.id+"/complete",{method:"POST"}).finally(this._receivePlayCompleted.bind(this))},En.prototype._receivePlayCompleted=function(){if(this.config.pendingRequest)tt("song finished, but we're still waiting for next one to return"),this._assignCurrentPlay(null,!0);else{tt("song finished, and no outstanding request, so playing pendingPlay");var t=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(t)}},En.prototype.reportPlayStopped=function(t){this.config.current&&this.config.current.started&&this._signedAjax(gi()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:t}),headers:{"Content-Type":"application/json"}}),this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0)},En.prototype.requestSkip=function(){var t=this;if(!this.config.current)throw new Error("No song being played");if(!this.config.current.started)throw new Error("No song has been started");this.config.current.canSkip?this._signedAjax(gi()+"/api/v2/play/"+this.config.current.play.id+"/skip",{method:"POST"}).then(function(t){return t.json()}).then(this._receiveSkip.bind(this,this.config.current.play)).catch(this._failSkip.bind(this,this.config.current.play)):setTimeout(function(){t.trigger("skip-denied")},1)},En.prototype.requestInvalidate=function(){if(!this.config.current)throw new Error("No active song to invalidate!");this._sendInvalidate(this.config.current.play)},En.prototype._sendInvalidate=function(t,e){this._signedAjax(gi()+"/api/v2/play/"+t.id+"/invalidate",{method:"POST"}).then(function(t){return t.json()}).then(this._receiveInvalidate.bind(this,t)).catch(this._failInvalidate.bind(this,e,t))},En.prototype._failInvalidate=function(t,e,i){var n=this;(t=t?2*t:200)<3e3?setTimeout(function(){n._sendInvalidate(e)},t):tt("gave up trying to invalidate play",i)},En.prototype._receiveInvalidate=function(t,e){if(tt("invalidate response"),this.config.current&&this.config.current.play===t)if(e.success)if(this.config.pendingPlay){tt("invalidating to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else tt("invalidating current song"),this._assignCurrentPlay(null,!0),this.config.pendingRequest||(tt("queueing up new song"),this._requestNextPlay());else tt("failed invalidate! - technically this is impossible")},En.prototype._failSkip=function(t){this.config.current&&this.config.current.play===t&&this.trigger("skip-denied")},En.prototype._receiveSkip=function(t,e){if(this.config.current&&this.config.current.play===t){if(!e.success)return tt("failed skip!"),void this.trigger("skip-denied");if(this.config.pendingPlay){tt("skipping to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else this.config.pendingRequest?(tt("skipping to what is queued up"),this._assignCurrentPlay(null,!0)):(tt("skipping to what is queued up"),this._assignCurrentPlay(null))}},En.prototype._startPlay=function(t){2<this.config.current.retryCount?this._receiveStartPlay(t,{success:!0,can_skip:!0}):(tt("telling server we're starting the play",t),this._signedAjax(gi()+"/api/v2/play/"+t.id+"/start",{method:"POST"}).then(function(t){return t.json()}).then(this._receiveStartPlay.bind(this,t)).catch(this._failStartPlay.bind(this,t)))},En.prototype._receiveStartPlay=function(t,e){e.success?this.config.current&&this.config.current.play===t?(this.config.current.canSkip=e.can_skip,this.config.current.started=!0,this._requestNextPlay(),this.trigger("play-started",t)):tt("received start play, but not waiting any more"):tt("received failed start success")},En.prototype._failStartPlay=function(t,e){var i=this;if(tt("start failed",e),this.config.current&&this.config.current.play===t){if(403===e.status)try{var n=JSON.parse(e.responseText);if(n.error&&20===n.error.code)return this._receiveStartPlay(t,{success:!0,can_skip:!0})}catch(t){tt("unable to parse start play response",t.message)}tt("request failed - trying again in 1 second",e),this.config.current.retryCount++,setTimeout(function(){i._startPlay(t)})}else tt("startPlay failed, but we don't care any more")},En.prototype._assignCurrentPlay=function(t,e){if(this.config.current){var i=this.config.current.play;this.config.current=null,this.trigger("play-completed",i)}null===t?e?tt("nothing to play... waiting"):(tt("nothing to play from the current station"),this.trigger("plays-exhausted")):(this.config.current={play:t,canSkip:!1,started:!1,retryCount:0},tt("activated new song"),this.trigger("play-active",t))},En.prototype._requestNextPlay=function(o){var r=this;On().then(function(t){if(r.config.pendingRequest){if(o){if(6e4<o)return tt("giving up on retrieving next play"),void((r.config.pendingRequest=null)===r.config.current&&r._assignCurrentPlay(null));tt("retrying pending request"),r.config.pendingRequest.retryCount++;var e=r.config.pendingRequest.ajax;return void r._signedAjax(r.config.pendingRequest.url,e).then(function(t){return t.json()}).then(r._receiveNextPlay.bind(r,e)).catch(r._failedNextPlay.bind(r,o,e))}tt("already waiting for a request to finish")}else{var i={formats:r.config.formats,client_id:t,max_bitrate:r.config.maxBitrate,secure:!0};r.config.placementId&&(i.placement_id=r.config.placementId),r.config.stationId&&(i.station_id=r.config.stationId);var n={method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}};r.config.pendingRequest={url:gi()+"/api/v2/play",ajax:n,retryCount:0},tt("requesting new play from server",n),r._signedAjax(gi()+"/api/v2/play",n).then(function(t){return t.json()}).then(r._receiveNextPlay.bind(r,n)).catch(r._failedNextPlay.bind(r,o,n))}})},En.prototype._receiveNextPlay=function(t,e){this.config.pendingRequest&&this.config.pendingRequest.ajax===t?(this.config.pendingRequest=null,e.success?(this.trigger("prepare-sound",e.play.audio_file.url),this.config.current?(tt("received play, but we're already playing, so queueing up",e.play),this.config.pendingPlay=e.play):(tt("received play and no current song, making active now",e.play),this._assignCurrentPlay(e.play))):e.error&&9===e.error.code?this.config.current?(tt("ran out of music to play, but we're already playing"),this.config.pendingPlay=null):(tt("ran out of music, and nothing playing now"),this.trigger("plays-exhausted")):tt("unsuccessful response",e)):tt("nextPlay succeeded, but we don't care")},En.prototype._failedNextPlay=function(t,e,i){var n=this;if(tt("next play failed",i),this.config.pendingRequest&&this.config.pendingRequest.ajax===e){if(403===i.status)try{var o=JSON.parse(i.responseText);if(o.error&&19===o.error.code)return void this.trigger("not-in-us",o.error.message)}catch(t){tt("problem parsing 403 response",t.message)}t=Math.min(t?2*t:500,2e3),tt("request failed - trying again after "+t+"ms"),setTimeout(function(){n._requestNextPlay(t)},t)}else tt("nextPlay failed, but we don't care")},En.prototype.maybeCanSkip=function(){return this.config.current&&this.config.current.started&&this.config.current.canSkip},En.prototype.likePlay=function(t){this._signedAjax(gi()+"/api/v2/play/"+t+"/like",{method:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!0)},En.prototype.unlikePlay=function(t){this._signedAjax(gi()+"/api/v2/play/"+t+"/like",{method:"DELETE"}),this.config.current&&this.config.current.play.id===t&&delete this.config.current.play.liked},En.prototype.dislikePlay=function(t){this._signedAjax(gi()+"/api/v2/play/"+t+"/dislike",{method:"POST"}),this.config.current&&this.config.current.play.id===t&&(this.config.current.play.liked=!1)},En.prototype.suspend=function(t){var e={};return this.config.placementId&&(e.placementId=this.config.placementId),this.config.stationId&&(e.stationId=this.config.stationId),this.config.current&&this.config.current.started&&(e.placement=this.config.placement,e.stations=this.config.stations,e.play=function(o){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},e=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.forEach(function(t){var e,i,n;e=o,n=r[i=t],i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n})}return o}({},this.config.current.play),e.play.startPosition=t,e.canSkip=this.config.current.canSkip),e},En.prototype.unsuspend=function(t){if(this.getActivePlay())throw new Error("You cannot unsuspend after running tune()");return"placementId"in t&&(this.config.placementId=t.placementId,this.trigger("placement-changed",this.config.placementId)),"stationId"in t&&(this.config.stationId=t.stationId,this.trigger("station-changed",this.config.stationId)),"play"in t?(this.config.placement=t.placement,this.config.stations=t.stations,this.trigger("placement",this.config.placement),this.trigger("stations",this.config.stations),this._assignCurrentPlay(t.play),this._receiveStartPlay(t.play,{success:!0,can_skip:t.canSkip}),t.play):(this.tune(),null)};function An(){try{return"localStorage"in window&&null!==window.localStorage&&(window.localStorage["feed-test"]=!0)}catch(t){return!1}}En.prototype._getStoredCid=function(){return pi("cid")},En.prototype._setStoredCid=function(t){fi("cid",t,{expires:3650,path:"/"})},En.prototype._deleteStoredCid=function(){hi("cid")},En.prototype._sign=function(t){var e;if(t||(t={}),e="Basic "+btoa(this.config.token+":"+this.config.secret),t.headers?t.headers.Authorization=e:t.headers={Authorization:e},t.headers["X-Feed-SDK"]=ii+" js",this.extraHeaders)for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&(t.headers[i]=this.extraHeaders[i]);return t},En.prototype._signedAjax=function(t,e){return this._ajax(t,this._sign(e))},En.prototype._ajax=function(t,e){return fetch(t,e)},En.prototype._submitLogHistory=function(){var t=tt.history;return tt.history=[],this._signedAjax("https://feed.fm/api/v2/session/event",{method:"POST",body:JSON.stringify({event:"playerHistory",parameters:t}),headers:{"Content-Type":"application/json"}})};var xn=function(t,e,i){var n=this;i=i||{},this.state={paused:!0,simulcast:i.simulcast},i.debug&&tt.enable(),this.trimming=i.trimming||!1,this.normalizeVolume=i.normalizeVolume||!0,this.secondsOfCrossfade=i.secondsOfCrossfade||0,this.crossfadeIn=i.crossfadeIn||!1,Object.assign(this,$e);var o=this.session=new En(t,e,i);this.session.on("play-active",this._onPlayActive,this),this.session.on("play-started",this._onPlayStarted,this),this.session.on("play-completed",this._onPlayCompleted,this),this.session.on("plays-exhausted",this._onPlaysExhausted,this),this.session.on("prepare-sound",this._onPrepareSound,this);for(var r=this,s=["not-in-us","invalid-credentials","placement","stations","placement-changed","station-changed","skip-denied"],a=function(){var t=s[u];n.session.on(t,function(){r.trigger.apply(r,[t].concat(Array.prototype.slice.call(arguments,0)))})},u=0;u<s.length;u++)a();i.debug&&this.session.on("play-active",function(){r.trigger.apply(r,["play-active"].concat(Array.prototype.slice.call(arguments,0)))});var c=this.speaker=new ei;if(i.brokenWebkitFormats&&ei.brokenWebkit){var l=i.brokenWebkitFormats.split(","),d=c.getSupportedFormats().split(","),p=De(l,d),f=p.join(",");tt("input format list is",l,d),tt("final support list is",f),0===p.length&&(f=c.getSupportedFormats()),o.setFormats(f)}else if(i.formats){var h=i.formats.split(","),y=c.getSupportedFormats().split(","),g=De(h,y),v=g.join(",");0===g.length&&(v=c.getSupportedFormats()),tt("input format list is",h,y),tt("final support list is",v),o.setFormats(v)}else o.setFormats(c.getSupportedFormats());this.setMuted(this.isMuted())};xn.prototype.initializeAudio=function(){tt("INTIALIZE AUDIO"),this.speaker.initializeAudio()},xn.prototype.setPlacementId=function(t){tt("SET PLACEMENT ID",t),this.session.setPlacementId(t)},xn.prototype.setStationId=function(t){tt("SET STATION ID",t),this.session.setStationId(t)},xn.prototype.setBaseUrl=function(t){this.session.setBaseUrl(t)},xn.prototype._onPlayActive=function(t){var e={play:this._onSoundPlay.bind(this,t.id),pause:this._onSoundPause.bind(this,t.id),finish:this._onSoundFinish.bind(this,t.id),elapse:this._onSoundElapse.bind(this,t.id)};this.normalizeVolume&&(e.gain=(t.audio_file.replaygain_track_gain||0)+(t.station.pre_gain||0)),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_start&&(e.startPosition=1e3*t.audio_file.extra.trim_start),this.trimming&&t.audio_file.extra&&t.audio_file.extra.trim_end&&t.audio_file.duration_in_seconds&&(e.endPosition=1e3*(t.audio_file.duration_in_seconds-t.audio_file.extra.trim_end)),this.secondsOfCrossfade&&(this.crossfadeIn&&(e.fadeInSeconds=this.secondsOfCrossfade),e.fadeOutSeconds=this.secondsOfCrossfade);var i=this.speaker.create(t.audio_file.url,e);(this.state.activePlay={id:t.id,sound:i,startReportedToServer:!1,soundCompleted:!1,playStarted:!1,previousPosition:0},this.state.paused)||this.state.activePlay.sound.play()},xn.prototype._onSoundPlay=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){if(this.state.paused=!1,this.state.activePlay.playStarted=!0,!this.state.activePlay.startReportedToServer)return this.session.reportPlayStarted();this.trigger("play-resumed",this.session.getActivePlay())}else tt("received sound play, but active play does not match",this.state.activePlay,t)},xn.prototype.getActivePlay=function(){return this.session.getActivePlay()},xn.prototype.hasActivePlayStarted=function(){return this.session.hasActivePlayStarted()},xn.prototype.getActivePlacement=function(){return this.session.getActivePlacement()},xn.prototype._onSoundPause=function(t){this.state.activePlay&&this.state.activePlay.id===t?(this.state.paused=!0,this.trigger("play-paused",this.session.getActivePlay())):tt("received sound pause, but active play does not match",this.state.activePlay,t)},xn.prototype._onSoundFinish=function(t,e){if(this.state.activePlay&&this.state.activePlay.id===t){if(this.state.activePlay.soundCompleted=!0,e&&(this.state.activePlay.soundCompletedWithError=!0,"NotAllowedError"===e.name))return console.error('Feed.fm: first call to "initializeAudio()" or "play()" must be made in user-initiated event handler'),void this.stop();this.state.activePlay.playStarted?this.state.activePlay.startReportedToServer&&(e?(tt("song completed with error - marking as invalid"),this.session.requestInvalidate()):this.session.reportPlayCompleted()):this.session.requestInvalidate()}else tt("received sound finish, but active play does not match",this.state.activePlay,t)},xn.prototype._onSoundElapse=function(t){if(this.state.activePlay&&this.state.activePlay.id===t){var e=this.state.activePlay.sound.position(),i=Math.floor(this.state.activePlay.previousPosition/3e4),n=Math.floor(e/3e4);this.state.activePlay.previousPosition=e,n!==i&&this.session.reportPlayElapsed(Math.floor(e/1e3))}else tt("received sound elapse, but active play does not match",this.state.activePlay,t)},xn.prototype._onPlayStarted=function(t){var e=this.session;this.state.activePlay&&this.state.activePlay.id===t.id?(this.state.activePlay.startReportedToServer=!0,this.state.activePlay.soundCompleted&&(tt("sound completed before we finished reporting start",this.state.activePlay),this.state.activePlay.soundCompletedWithError?setTimeout(function(){return e.requestInvalidate()},1):setTimeout(function(){return e.reportPlayCompleted()},1)),this.updateSimulcast(),this.trigger("play-started",t)):tt("received play started, but it does not match active play",t,this.state.activePlay)},xn.prototype._onPlayCompleted=function(t){if(this.state.activePlay&&this.state.activePlay.id===t.id){this.state.activePlay.sound.destroy();var e=this.state.activePlay.playStarted;delete this.state.activePlay,e&&this.trigger("play-completed",t)}else tt("received play completed, but it does not match active play",t,this.state.activePlay)},xn.prototype._onPlaysExhausted=function(){this.state.paused=!1,this.updateSimulcast(),this.trigger("plays-exhausted")},xn.prototype._onPrepareSound=function(t){tt("preparing",t),this.speaker.prepare(t)},xn.prototype.isPaused=function(){return this.session.isTuned()&&this.state.paused},xn.prototype.getStationInformation=function(t){return this.session.getStationInformation(t)},xn.prototype.tune=function(){tt("TUNE"),this.session.isTuned()||this.session.tune()},xn.prototype.play=function(){tt("PLAY");var t=this.session,e=this.state;if(this.speaker.initializeAudio(),!t.isTuned())return e.paused=!1,t.tune();t.getActivePlay()&&e.activePlay&&e.paused&&(e.activePlay.playStarted?e.activePlay.sound.resume():e.activePlay.sound.play()),e.paused=!1,this.updateSimulcast()},xn.prototype.pause=function(){tt("PAUSE"),this.session.hasActivePlayStarted()&&this.state.activePlay&&!this.state.paused&&(this.state.activePlay.sound.pause(),this.state.paused=!0,this.updateSimulcast())},xn.prototype.like=function(){tt("LIKE"),this.session.hasActivePlayStarted()&&(this.session.likePlay(this.state.activePlay.id),this.trigger("play-liked"))},xn.prototype.unlike=function(){tt("UNLIKE"),this.session.hasActivePlayStarted()&&(this.session.unlikePlay(this.state.activePlay.id),this.trigger("play-unliked"))},xn.prototype.dislike=function(){tt("DISLIKE"),this.session.hasActivePlayStarted()&&(this.session.dislikePlay(this.state.activePlay.id),this.trigger("play-disliked"),this.state.paused=!1,this.skip())},xn.prototype.skip=function(){tt("SKIP"),this.session.hasActivePlayStarted()&&(this.state.paused=!1,this.session.requestSkip())},xn.prototype.stop=function(){tt("STOP"),this.state.paused=!0;var t=this.state.activePlay;if(t&&t.sound){if(tt("stopping active play",t),t.startReportedToServer){var e=t.sound.position();this.session.reportPlayStopped(Math.floor(e/1e3))}t.sound.pause(),t.sound.destroy()}else tt("no active play");delete this.state.activePlay,this.speaker.flush(),this.trigger("play-stopped"),this.updateSimulcast()},xn.prototype.destroy=function(){this.session=null,this.state.activePlay&&this.state.activePlay.sound&&this.state.activePlay.sound.destroy()},xn.prototype.getCurrentState=function(){return this.state.suspended?"suspended":this.session.hasActivePlayStarted()?this.state.paused?"paused":"playing":"idle"},xn.prototype.getPosition=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.position():0},xn.prototype.getDuration=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.duration():0},xn.prototype.maybeCanSkip=function(){return!!this.session.maybeCanSkip()};var Tn="muted";xn.prototype.isMuted=function(){return!!(An()&&Tn in localStorage)&&"true"===localStorage[Tn]},xn.prototype.setMuted=function(t){t?(this.speaker.setVolume(0),An()&&(localStorage[Tn]=!0),this.trigger("muted")):(this.speaker.setVolume(100),An()&&(localStorage[Tn]=!1),this.trigger("unmuted"))},xn.prototype.updateSimulcast=function(){var e=this;if(this.state.simulcast){var i=this.getCurrentState();"suspended"===i&&(i="idle"),On().then(function(t){e.session._signedAjax(gi()+"/api/v2/simulcast/".concat(e.state.simulcast,"/in-progress"),{method:"POST",body:JSON.stringify({state:i,client_id:t}),headers:{"Content-Type":"application/json"}})})}};var In=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,$e),this._uuid=t,this._state="idle"}var t,i,n;return t=e,(i=[{key:"listen",value:function(){var e=this;this._timeout&&(clearTimeout(this._timeout),delete this._timeout),On().then(function(t){e.onTimeout(t)})}},{key:"onTimeout",value:function(o){var r=this;fetch(gi()+"/api/v2/simulcast/".concat(this._uuid,"/listen"),{method:"POST",body:JSON.stringify({client_id:o}),headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){var e=5e3;if(t.success){var i="idle"===t.state&&"idle"!==r._state,n=r._activePlay;if("idle"===(r._state=t.state)){if(delete r._activePlay,i)try{r.trigger("music-stopped")}catch(t){}}else{if(r._activePlay=t.play,!n||n.id!==r._activePlay.id)try{r.trigger("play-started",r._activePlay)}catch(t){}20<t.seconds_since_start&&20<t.play.duration_in_seconds-t.seconds_since_start&&(e=15e3)}}r._timeout=setTimeout(function(){r.onTimeout(o)},e)}).catch(function(t){if(403===t.status)try{var e=JSON.parse(t.responseText);if(19===e.id){try{r.trigger("not-in-us")}catch(t){}return}console.log("unexpected error:",e)}catch(t){console.log("bad response",t.message)}else console.log("odd response",t);r._timeout=setTimeout(function(){r.onTimeout(o)},15e3)})}},{key:"getCurrentState",value:function(){return this._state}},{key:"getCurrentPlay",value:function(){return this._activePlay}}])&&pt(t.prototype,i),n&&pt(t,n),e}(),jn={f:ut},Cn=l.f,Ln=function(t){var e=g.Symbol||(g.Symbol=y.Symbol||{});"_"==t.charAt(0)||t in e||Cn(e,t,{value:jn.f(t)})};Ln("asyncIterator");var Rn=t(function(t){var i=m("meta"),e=l.f,n=0,o=Object.isExtensible||function(){return!0},r=!u(function(){return o(Object.preventExtensions({}))}),s=function(t){e(t,i,{value:{i:"O"+ ++n,w:{}}})},a=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!c(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!p(t,i)){if(!o(t))return"F";if(!e)return"E";s(t)}return t[i].i},getWeak:function(t,e){if(!p(t,i)){if(!o(t))return!0;if(!e)return!1;s(t)}return t[i].w},onFreeze:function(t){return r&&a.NEED&&o(t)&&!p(t,i)&&s(t),t}}}),qn=(Rn.KEY,Rn.NEED,Rn.fastKey,Rn.getWeak,Rn.onFreeze,Pe.f),Nn={}.toString,Mn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Bn={f:function(t){return Mn&&"[object Window]"==Nn.call(t)?function(t){try{return qn(t)}catch(t){return Mn.slice()}}(t):qn(C(t))}},Dn=Rn.KEY,Fn=ve.f,Vn=l.f,$n=Bn.f,Un=y.Symbol,Wn=y.JSON,zn=Wn&&Wn.stringify,Hn="prototype",Jn=ut("_hidden"),Gn=ut("toPrimitive"),Kn={}.propertyIsEnumerable,Yn=F("symbol-registry"),Qn=F("symbols"),Xn=F("op-symbols"),Zn=Object[Hn],to="function"==typeof Un,eo=y.QObject,io=!eo||!eo[Hn]||!eo[Hn].findChild,no=n&&u(function(){return 7!=Ot(Vn({},"a",{get:function(){return Vn(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=Fn(Zn,e);n&&delete Zn[e],Vn(t,e,i),n&&t!==Zn&&Vn(Zn,e,n)}:Vn,oo=function(t){var e=Qn[t]=Ot(Un[Hn]);return e._k=t,e},ro=to&&"symbol"==typeof Un.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Un},so=function(t,e,i){return t===Zn&&so(Xn,e,i),v(t),e=s(e,!0),v(i),p(Qn,e)?(i.enumerable?(p(t,Jn)&&t[Jn][e]&&(t[Jn][e]=!1),i=Ot(i,{enumerable:S(0,!1)})):(p(t,Jn)||Vn(t,Jn,S(1,{})),t[Jn][e]=!0),no(t,e,i)):Vn(t,e,i)},ao=function(t,e){v(t);for(var i,n=function(t){var e=J(t),i=G.f;if(i)for(var n,o=i(t),r=K.f,s=0;o.length>s;)r.call(t,n=o[s++])&&e.push(n);return e}(e=C(e)),o=0,r=n.length;o<r;)so(t,i=n[o++],e[i]);return t},uo=function(t){var e=Kn.call(this,t=s(t,!0));return!(this===Zn&&p(Qn,t)&&!p(Xn,t))&&(!(e||!p(this,t)||!p(Qn,t)||p(this,Jn)&&this[Jn][t])||e)},co=function(t,e){if(t=C(t),e=s(e,!0),t!==Zn||!p(Qn,e)||p(Xn,e)){var i=Fn(t,e);return!i||!p(Qn,e)||p(t,Jn)&&t[Jn][e]||(i.enumerable=!0),i}},lo=function(t){for(var e,i=$n(C(t)),n=[],o=0;i.length>o;)p(Qn,e=i[o++])||e==Jn||e==Dn||n.push(e);return n},po=function(t){for(var e,i=t===Zn,n=$n(i?Xn:C(t)),o=[],r=0;n.length>r;)!p(Qn,e=n[r++])||i&&!p(Zn,e)||o.push(Qn[e]);return o};to||(w((Un=function(){if(this instanceof Un)throw TypeError("Symbol is not a constructor!");var e=m(0<arguments.length?arguments[0]:void 0),i=function(t){this===Zn&&i.call(Xn,t),p(this,Jn)&&p(this[Jn],e)&&(this[Jn][e]=!1),no(this,e,S(1,t))};return n&&io&&no(Zn,e,{configurable:!0,set:i}),oo(e)})[Hn],"toString",function(){return this._k}),ve.f=co,l.f=so,Pe.f=Bn.f=lo,K.f=uo,G.f=po,n&&w(Zn,"propertyIsEnumerable",uo,!0),jn.f=function(t){return oo(ut(t))}),A(A.G+A.W+A.F*!to,{Symbol:Un});for(var fo="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ho=0;fo.length>ho;)ut(fo[ho++]);for(var yo=J(ut.store),go=0;yo.length>go;)Ln(yo[go++]);A(A.S+A.F*!to,"Symbol",{for:function(t){return p(Yn,t+="")?Yn[t]:Yn[t]=Un(t)},keyFor:function(t){if(!ro(t))throw TypeError(t+" is not a symbol!");for(var e in Yn)if(Yn[e]===t)return e},useSetter:function(){io=!0},useSimple:function(){io=!1}}),A(A.S+A.F*!to,"Object",{create:function(t,e){return void 0===e?Ot(t):ao(Ot(t),e)},defineProperty:so,defineProperties:ao,getOwnPropertyDescriptor:co,getOwnPropertyNames:lo,getOwnPropertySymbols:po}),Wn&&A(A.S+A.F*(!to||u(function(){var t=Un();return"[null]"!=zn([t])||"{}"!=zn({a:t})||"{}"!=zn(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],o=1;arguments.length>o;)n.push(arguments[o++]);if(i=e=n[1],(c(e)||void 0!==t)&&!ro(t))return de(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!ro(e))return e}),n[1]=e,zn.apply(Wn,n)}}),Un[Hn][Gn]||k(Un[Hn],Gn,Un[Hn].valueOf),xt(Un,"Symbol"),xt(Math,"Math",!0),xt(y.JSON,"JSON",!0),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var i=0;i<this.length;i++)t.call(e,this[i],i,this)});var vo=function(t,e){var i=this;this.alertId=null,this.durationId=null,this.startedPlayback=!1,this.$el=t instanceof Element?t:document.getElementById(t),this.player=e,this.player.on("placement",this._onPlacement,this),this.player.on("play-started",this._onPlayStarted,this),this.player.on("play-paused",this._onPlayPaused,this),this.player.on("play-resumed",this._onPlayResumed,this),this.player.on("play-completed",this._onPlayCompleted,this),this.player.on("play-stopped",this._onPlayStopped,this),this.player.on("play-liked",this._onPlayLiked,this),this.player.on("play-unliked",this._onPlayUnliked,this),this.player.on("play-disliked",this._onPlayDisliked,this),this.player.on("plays-exhausted",this._onPlaysExhausted,this),this.player.on("skip-denied",this._onSkipDenied,this),this.player.on("suspend",this._onSuspend,this),this._enableButtonsBasedOnState(),this.displayText=this.originalDisplayText=this.$el.querySelector(".status").innerHTML,this.renderStatus(),this.$el.querySelectorAll(".status").forEach(function(t){t.addEventListener("click",i._onStatusClick.bind(i))}),this.$el.querySelectorAll(".play-button, .start-button, .resume-button").forEach(function(t){t.addEventListener("click",i._onPlayButtonClick.bind(i))}),this.$el.querySelectorAll(".pause-button").forEach(function(t){t.addEventListener("click",i._onPauseButtonClick.bind(i))}),this.$el.querySelectorAll(".skip-button").forEach(function(t){t.addEventListener("click",i._onSkipButtonClick.bind(i))}),this.$el.querySelectorAll(".like-button").forEach(function(t){t.addEventListener("click",i._onLikeButtonClick.bind(i))}),this.$el.querySelectorAll(".dislike-button").forEach(function(t){t.addEventListener("click",i._onDislikeButtonClick.bind(i))})};function mo(t){var e=Math.floor(t/1e3),i=e%60;return i<10&&(i="0"+i),Math.floor(e/60)+":"+i}return vo.prototype._onStatusClick=function(){"playing"===this.player.getCurrentState()?this._onPauseButtonClick():this._onPlayButtonClick()},vo.prototype._onPlayButtonClick=function(){this.player.initializeAudio(),this.player.play()},vo.prototype._onPauseButtonClick=function(){this.player.pause()},vo.prototype._onSkipButtonClick=function(){this.player.skip()},vo.prototype._onLikeButtonClick=function(t){tt("like button clicked!",t.target,this),t.target.classList.contains("liked")?this.player.unlike():this.player.like()},vo.prototype._onDislikeButtonClick=function(){this.player.dislike()},vo.prototype.$=function(t){return this.$el.find(t)},vo.prototype._onPlacement=function(t){this.originalDisplayText||(this.originalDisplayText=this.formatPlacement(t),this.renderStatus(this.originalDisplayText))},vo.prototype.formatPlacement=function(t){return"Tune in to <em class='placement'>"+t.name+"</em>"},vo.prototype._onPlayStarted=function(t){this.startedPlayback=!0,this.renderStatus(this.formatPlay(t)),this._enableButtonsBasedOnState(),this._setLikeStatus(t.liked),this._enablePositionTracker()},vo.prototype._enablePositionTracker=function(){var t=this;this.durationId||(this.durationId=window.setInterval(function(){t.renderPosition(t.player.getPosition(),t.player.getDuration())},500))},vo.prototype._setLikeStatus=function(t){var e=this.$el.querySelectorAll(".like-button"),i=this.$el.querySelectorAll(".dislike-button");!0===t?(e.forEach(function(t){t.classList.add("liked")}),i.forEach(function(t){t.classList.remove("disliked")})):!1===t?(e.forEach(function(t){t.classList.remove("liked")}),i.forEach(function(t){t.classList.add("disliked")})):(e.forEach(function(t){t.classList.remove("liked")}),i.forEach(function(t){t.classList.remove("disliked")}))},vo.prototype._disablePositionTracker=function(){this.durationId&&(window.clearInterval(this.durationId),this.durationId=null)},vo.prototype._onPlayResumed=function(){this._enablePositionTracker(),this._enableButtonsBasedOnState()},vo.prototype._onPlayPaused=function(){this._disablePositionTracker(),this._enableButtonsBasedOnState()},vo.prototype._onPlayCompleted=function(){this.renderPosition(0,0),this._enableButtonsBasedOnState()},vo.prototype._onPlayStopped=function(){this.renderStatus(this.originalDisplayText),this.renderPosition(0,0),this._enableButtonsBasedOnState()},vo.prototype._onPlaysExhausted=function(){this.renderStatus(this.originalDisplayText),this.renderAlert("There is no more music to play in this station!"),this._enableButtonsBasedOnState()},vo.prototype._onPlayLiked=function(){this._setLikeStatus(!0)},vo.prototype._onPlayDisliked=function(){this._setLikeStatus(!1)},vo.prototype._onPlayUnliked=function(){this._setLikeStatus()},vo.prototype._onSkipDenied=function(){this.renderAlert("Sorry you've temporarily run out of skips!")},vo.prototype.formatPlay=function(t){return"<span class='track'>"+t.audio_file.track.title+"</span> by <span class='artist'>"+t.audio_file.artist.name+"</span> on <span class='release'>"+t.audio_file.release.title+"</span>"},vo.prototype.renderStatus=function(t){var e=this;void 0!==t&&(this.displayText=t),this.alertId||this.$el.querySelectorAll(".status").forEach(function(t){t.innerHTML=e.displayText,t.classList.remove("alert")})},vo.prototype.renderPosition=function(e,i){if(this.$el.querySelectorAll(".elapsed").forEach(function(t){t.innerHTML=mo(e)}),this.$el.querySelectorAll(".duration").forEach(function(t){t.innerHTML=mo(i)}),0===i)this.$el.querySelectorAll(".progress").forEach(function(t){t.style.width="0"});else{var n=Math.round((e+1e3)/i*100);n=100<n?100:n,this.$el.querySelectorAll(".progress").forEach(function(t){t.style.width=n+"%"})}},vo.prototype.renderAlert=function(e){this.alertId&&window.clearTimeout(this.alertId),this.$el.querySelectorAll(".status").forEach(function(t){t.innerHTML=e,t.classList.add("alert")});var t=this;this.alertId=window.setTimeout(function(){t.alertId=null,t.renderStatus()},3e3)},vo.prototype._onSuspend=function(){this._enableButtonsBasedOnState()},vo.prototype._enableButtonsBasedOnState=function(){var t,e,i=this.player.getCurrentState();switch(i){case"playing":t=[".pause-button",".like-button",".dislike-button"],e=[".play-button",".start-button",".resume-button"],this.player.maybeCanSkip()?t.push(".skip-button"):e.push(".skip-button");break;case"paused":t=[".play-button",".resume-button",".like-button",".dislike-button"],e=[".pause-button",".start-button"],this.player.maybeCanSkip()?t.push(".skip-button"):e.push(".skip-button");break;case"suspended":t=[],e=[".play-button",".resume-button",".like-button",".dislike-button",".pause-button",".start-button",".skip-button"];break;default:t=[".play-button",".start-button"],e=[".resume-button",".pause-button",".like-button",".dislike-button",".skip-button"]}var n=!0,o=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;this.$el.querySelectorAll(u).forEach(function(t){t.classList.remove("button-enabled"),t.classList.add("button-disabled"),t.disabled=!0})}}catch(t){o=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}var c=!0,l=!1,d=void 0;try{for(var p,f=t[Symbol.iterator]();!(c=(p=f.next()).done);c=!0){var h=p.value;this.$el.querySelectorAll(h).forEach(function(t){t.classList.remove("button-disabled"),t.classList.add("button-enabled"),t.disabled=!1})}}catch(t){l=!0,d=t}finally{try{c||null==f.return||f.return()}finally{if(l)throw d}}var y=this.$el.classList;y.remove("state-playing"),y.remove("state-paused"),y.remove("state-idle"),y.remove("state-suspended"),y.add("state-"+i)},{Speaker:ei,Session:En,Player:xn,Listener:In,PlayerView:vo,log:tt,version:ii,resetClientId:function(){hi(kn),Sn=null}}}();
